<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your Idle Game</title>
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/creator.css">
    <link rel="stylesheet" href="styles/modals.css">
</head>
<body>
    <div class="creator-container">
        <!-- Header -->
        <header class="creator-header">
            <div class="creator-title">
                <h1>Game Creator</h1>
                <p>Build your own idle game without coding</p>
            </div>
            <div class="creator-actions">
                <button class="btn-secondary" onclick="creator.preview()">üëÅÔ∏è Preview</button>
                <a href="index.html" class="btn-secondary">‚Üê Home</a>
            </div>
        </header>

        <!-- Progress Indicator -->
        <div class="progress-bar">
            <div class="step-indicator active" data-step="1" onclick="creator.goToStep(1)">
                <span class="step-number">1</span>
                <span class="step-label">Game Info</span>
            </div>
            <div class="step-indicator" data-step="2" onclick="creator.goToStep(2)">
                <span class="step-number">2</span>
                <span class="step-label">Theme</span>
            </div>
            <div class="step-indicator" data-step="3" onclick="creator.goToStep(3)">
                <span class="step-number">3</span>
                <span class="step-label">Upgrades</span>
            </div>
            <div class="step-indicator" data-step="4" onclick="creator.goToStep(4)">
                <span class="step-number">4</span>
                <span class="step-label">Export</span>
            </div>
        </div>

        <!-- Main Content -->
        <main class="creator-main" id="step-content">
            <!-- Step 1: Game Info -->
            <div class="creator-step" id="step-1">
                <h2>Game Information</h2>

                <div class="form-section">
                    <h3>Basic Info</h3>
                    <div class="form-group">
                        <label for="game-name">Game Name *</label>
                        <input type="text" id="game-name" placeholder="My Awesome Idle Game" required>
                    </div>
                    <div class="form-group">
                        <label for="game-description">Description</label>
                        <textarea id="game-description" rows="3" placeholder="A fun idle game about..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="game-author">Author</label>
                        <input type="text" id="game-author" placeholder="Your Name">
                    </div>
                </div>

                <div class="form-section">
                    <h3>Resources</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="resource-name">Resource Name (singular)</label>
                            <input type="text" id="resource-name" placeholder="Cookie">
                        </div>
                        <div class="form-group">
                            <label for="resource-plural">Resource Name (plural)</label>
                            <input type="text" id="resource-plural" placeholder="Cookies">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="resource-icon">Icon (emoji)</label>
                            <input type="text" id="resource-icon" placeholder="üç™" maxlength="2">
                        </div>
                        <div class="form-group">
                            <label for="click-verb">Click Verb</label>
                            <input type="text" id="click-verb" placeholder="Bake">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Settings</h3>
                    <div class="form-group">
                        <label for="cost-multiplier">Cost Multiplier (each level)</label>
                        <input type="number" id="cost-multiplier" value="1.15" min="1.01" max="2" step="0.01">
                        <small>How much more expensive each upgrade level gets (1.15 = 15% increase)</small>
                    </div>
                </div>
            </div>

            <!-- Step 2: Theme -->
            <div class="creator-step" id="step-2" style="display: none;">
                <h2>Theme & Colors</h2>

                <div class="theme-preview" id="theme-preview">
                    <div class="preview-card">
                        <div class="preview-header">
                            <h3>Preview</h3>
                            <div class="preview-stats">
                                <span>Points: 1,234</span>
                            </div>
                        </div>
                        <button class="preview-button">Click Me!</button>
                        <div class="preview-upgrade">
                            <span>Sample Upgrade</span>
                            <button class="preview-upgrade-btn">Buy (100)</button>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Color Scheme</h3>
                    <div class="color-grid">
                        <div class="form-group">
                            <label for="primary-color">Primary Color</label>
                            <div class="color-input-group">
                                <input type="color" id="primary-color" value="#4a90e2">
                                <input type="text" id="primary-color-text" value="#4a90e2" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="secondary-color">Secondary Color</label>
                            <div class="color-input-group">
                                <input type="color" id="secondary-color" value="#f39c12">
                                <input type="text" id="secondary-color-text" value="#f39c12" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="background-color">Background Color</label>
                            <div class="color-input-group">
                                <input type="color" id="background-color" value="#1a1a2e">
                                <input type="text" id="background-color-text" value="#1a1a2e" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="text-color">Text Color</label>
                            <div class="color-input-group">
                                <input type="color" id="text-color" value="#ffffff">
                                <input type="text" id="text-color-text" value="#ffffff" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Preset Themes</h3>
                    <div class="theme-presets">
                        <button class="theme-preset" data-theme="dark">Dark Mode</button>
                        <button class="theme-preset" data-theme="light">Light Mode</button>
                        <button class="theme-preset" data-theme="forest">Forest</button>
                        <button class="theme-preset" data-theme="ocean">Ocean</button>
                        <button class="theme-preset" data-theme="sunset">Sunset</button>
                    </div>
                </div>
            </div>

            <!-- Step 3: Upgrades -->
            <div class="creator-step" id="step-3" style="display: none;">
                <h2>Upgrades</h2>

                <div class="upgrades-manager">
                    <div class="upgrades-list-container">
                        <h3>Your Upgrades</h3>
                        <div id="upgrades-list">
                            <p class="empty-state">No upgrades yet. Add your first upgrade!</p>
                        </div>
                    </div>

                    <div class="upgrade-form-container">
                        <h3 id="upgrade-form-title">Add New Upgrade</h3>
                        <form id="upgrade-form" onsubmit="return false;">
                            <input type="hidden" id="upgrade-id">

                            <div class="form-group">
                                <label for="upgrade-name">Name *</label>
                                <input type="text" id="upgrade-name" placeholder="Auto Clicker" required>
                            </div>

                            <div class="form-group">
                                <label for="upgrade-description">Description</label>
                                <textarea id="upgrade-description" rows="2" placeholder="Automatically clicks for you"></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="upgrade-icon">Icon</label>
                                    <input type="text" id="upgrade-icon" placeholder="üñ±Ô∏è" maxlength="2">
                                </div>
                                <div class="form-group">
                                    <label for="upgrade-base-cost">Base Cost *</label>
                                    <input type="number" id="upgrade-base-cost" value="10" min="1" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="effect-type">Effect Type *</label>
                                <select id="effect-type" required>
                                    <option value="">-- Select Effect --</option>
                                </select>
                                <small id="effect-description"></small>
                            </div>

                            <div class="form-group">
                                <label for="effect-value">Effect Value *</label>
                                <input type="number" id="effect-value" value="1" min="0.01" step="0.01" required>
                            </div>

                            <div class="form-group">
                                <label for="unlock-condition-type">Unlock Condition</label>
                                <select id="unlock-condition-type">
                                    <option value="">Always Unlocked</option>
                                </select>
                                <small id="condition-description"></small>
                            </div>

                            <div class="form-group" id="unlock-value-group" style="display: none;">
                                <label for="unlock-condition-value">Condition Value</label>
                                <input type="number" id="unlock-condition-value" value="0" min="0">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="btn-primary" id="upgrade-form-submit">Add Upgrade</button>
                                <button type="button" class="btn-secondary" id="upgrade-form-cancel">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Step 4: Export -->
            <div class="creator-step" id="step-4" style="display: none;">
                <h2>Export Your Game</h2>

                <div class="export-summary">
                    <h3>Game Summary</h3>
                    <div class="summary-card" id="game-summary">
                        <p><strong>Name:</strong> <span id="summary-name">-</span></p>
                        <p><strong>Description:</strong> <span id="summary-description">-</span></p>
                        <p><strong>Author:</strong> <span id="summary-author">-</span></p>
                        <p><strong>Upgrades:</strong> <span id="summary-upgrades">0</span></p>
                        <p><strong>Resource:</strong> <span id="summary-resource">-</span></p>
                    </div>
                </div>

                <div class="export-actions">
                    <h3>Ready to Share?</h3>
                    <p>Click the button below to export your game. You'll get a shareable URL and code!</p>
                    <button class="btn-primary btn-large" onclick="creator.finish()">
                        üöÄ Export Game
                    </button>
                </div>

                <div class="export-tips">
                    <h3>Tips</h3>
                    <ul>
                        <li>Test your game using the Preview button before exporting</li>
                        <li>Make sure you have at least one upgrade</li>
                        <li>Share the URL with friends or save the code for later</li>
                        <li>You can always come back and create more games!</li>
                    </ul>
                </div>
            </div>
        </main>

        <!-- Navigation Footer -->
        <footer class="creator-footer">
            <button class="btn-secondary" id="prev-step-btn" onclick="creator.prevStep()" disabled>
                ‚Üê Previous
            </button>
            <button class="btn-primary" id="next-step-btn" onclick="creator.nextStep()">
                Next ‚Üí
            </button>
            <button class="btn-primary" id="finish-btn" onclick="creator.finish()" style="display: none;">
                üöÄ Finish
            </button>
        </footer>
    </div>

    <!-- Core Engine -->
    <script src="src/core/GameTemplate.js"></script>

    <!-- Engine Systems -->
    <script src="src/engine/EffectEngine.js"></script>
    <script src="src/engine/ConditionEngine.js"></script>

    <!-- Utils -->
    <script src="src/utils/compression.js"></script>

    <!-- UI Components -->
    <script src="src/ui/importExport.js"></script>

    <!-- Creator Components -->
    <script src="src/creator/EffectBuilder.js"></script>
    <script src="src/creator/ConditionBuilder.js"></script>
    <script src="src/creator/UpgradeBuilder.js"></script>
    <script src="src/creator/ThemeBuilder.js"></script>
    <script src="src/creator/CreatorApp.js"></script>

    <!-- Initialize Creator -->
    <script>
        const creator = new CreatorApp();

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            creator.initialize();
            console.log('Creator initialized');
            console.log('Template:', creator.template.getSummary());
        });

        // Expose for debugging
        window.creator = creator;
        window.EffectBuilder = EffectBuilder;
        window.ConditionBuilder = ConditionBuilder;
        window.UpgradeBuilder = UpgradeBuilder;
        window.ThemeBuilder = ThemeBuilder;

        console.log('Creator loaded! Access via window.creator');
        console.log('Available effect types:', effectEngine.getAvailableTypes());
        console.log('Available condition types:', conditionEngine.getAvailableTypes());
    </script>
</body>
</html>
